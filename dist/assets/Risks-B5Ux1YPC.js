import{r as h,a as w,j as e,B as n,h as _,f as l,I as b}from"./index-D0FyutOn.js";import{C as c,a as r,b as d,c as o}from"./card-C7X9d_pw.js";import{T as z,a as E,b as f,c as N}from"./tabs-D8dsfIBp.js";import{P as U}from"./plus-Cy-egXkT.js";import{C as B}from"./clock-DoB2HT0M.js";import{C as H,a as O}from"./circle-x-BsfKIglN.js";function J(){const[x,M]=h.useState([]),[A,L]=h.useState(!0),[I,v]=h.useState(!1),[t,i]=h.useState({title:"",description:"",probability:"medium",impact:"medium",category:"",projectId:"",assignee:"",dueDate:"",mitigationPlan:""});h.useEffect(()=>{y()},[]);const y=async()=>{try{const s=await w.get("/risks");M(s)}catch(s){console.error("Error fetching risks:",s)}finally{L(!1)}},S=async()=>{try{await w.post("/risks",t),i({title:"",description:"",probability:"medium",impact:"medium",category:"",projectId:"",assignee:"",dueDate:"",mitigationPlan:""}),v(!1),y()}catch(s){console.error("Error adding risk:",s)}},m=async(s,a)=>{try{await w.put(`/risks/${s}`,{status:a}),y()}catch(p){console.error("Error updating risk:",p)}},u=(s,a)=>{const p={low:1,medium:2,high:3},D=p[s]*p[a];return D<=3?{level:"Low",color:"bg-green-100 text-green-800"}:D<=6?{level:"Medium",color:"bg-yellow-100 text-yellow-800"}:{level:"High",color:"bg-red-100 text-red-800"}},T=s=>{switch(s){case"open":return"bg-red-100 text-red-800";case"mitigated":return"bg-yellow-100 text-yellow-800";case"closed":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},g=s=>{switch(s){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=s=>{switch(s){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},C=(x||[]).filter(s=>s.status==="open"),R=(x||[]).filter(s=>s.status==="mitigated"),P=(x||[]).filter(s=>s.status==="closed");return A?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Risk Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Identify, assess, and mitigate project risks"})]}),e.jsxs(n,{onClick:()=>v(!0),children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Add Risk"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(c,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Total Risks"}),e.jsx(_,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(x||[]).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All identified risks"})]})]}),e.jsxs(c,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Open Risks"}),e.jsx(B,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:C.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Requires attention"})]})]}),e.jsxs(c,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Mitigated"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:R.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Under control"})]})]}),e.jsxs(c,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Closed"}),e.jsx(O,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:P.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Resolved"})]})]})]}),e.jsxs(z,{defaultValue:"all",className:"space-y-4",children:[e.jsxs(E,{children:[e.jsx(f,{value:"all",children:"All Risks"}),e.jsx(f,{value:"open",children:"Open"}),e.jsx(f,{value:"mitigated",children:"Mitigated"}),e.jsx(f,{value:"closed",children:"Closed"})]}),e.jsx(N,{value:"all",className:"space-y-4",children:e.jsxs(c,{children:[e.jsx(r,{children:e.jsx(d,{children:"All Risks"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:(x||[]).map(s=>{const a=u(s.probability||"medium",s.impact||"medium");return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:s.title||"Untitled Risk"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description||"No description"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(l,{className:T(s.status||"open"),children:s.status||"open"}),e.jsxs(l,{className:a.color,children:[a.level," Risk"]})]})]}),e.jsxs("div",{className:"flex space-x-4 mb-2",children:[e.jsxs(l,{className:g(s.probability||"medium"),children:["Probability: ",s.probability||"medium"]}),e.jsxs(l,{className:j(s.impact||"medium"),children:["Impact: ",s.impact||"medium"]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Category: ",s.category||"Uncategorized"," | Assignee:"," ",s.assignee||"Unassigned"]}),s.mitigationPlan&&e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Mitigation Plan:"})," ",s.mitigationPlan]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Due:"," ",s.dueDate?new Date(s.dueDate).toLocaleDateString():"Not set"]}),e.jsxs("div",{className:"flex space-x-2",children:[s.status==="open"&&e.jsxs(e.Fragment,{children:[e.jsx(n,{size:"sm",variant:"outline",onClick:()=>m(s._id,"mitigated"),children:"Mark Mitigated"}),e.jsx(n,{size:"sm",variant:"outline",onClick:()=>m(s._id,"closed"),children:"Close"})]}),s.status==="mitigated"&&e.jsx(n,{size:"sm",variant:"outline",onClick:()=>m(s._id,"closed"),children:"Close"})]})]})]},s._id)})})})]})}),e.jsx(N,{value:"open",className:"space-y-4",children:e.jsxs(c,{children:[e.jsx(r,{children:e.jsx(d,{children:"Open Risks"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:C.map(s=>{const a=u(s.probability,s.impact);return e.jsxs("div",{className:"border rounded-lg p-4 border-red-200 bg-red-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsxs(l,{className:a.color,children:[a.level," Risk"]})]}),e.jsxs("div",{className:"flex space-x-4 mb-2",children:[e.jsxs(l,{className:g(s.probability),children:["Probability: ",s.probability]}),e.jsxs(l,{className:j(s.impact),children:["Impact: ",s.impact]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Category: ",s.category," | Assignee: ",s.assignee]}),s.mitigationPlan&&e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Mitigation Plan:"})," ",s.mitigationPlan]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Due: ",new Date(s.dueDate).toLocaleDateString()]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(n,{size:"sm",variant:"outline",onClick:()=>m(s._id,"mitigated"),children:"Mark Mitigated"}),e.jsx(n,{size:"sm",variant:"outline",onClick:()=>m(s._id,"closed"),children:"Close"})]})]})]},s._id)})})})]})}),e.jsx(N,{value:"mitigated",className:"space-y-4",children:e.jsxs(c,{children:[e.jsx(r,{children:e.jsx(d,{children:"Mitigated Risks"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:R.map(s=>{const a=u(s.probability,s.impact);return e.jsxs("div",{className:"border rounded-lg p-4 border-yellow-200 bg-yellow-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsxs(l,{className:a.color,children:[a.level," Risk"]})]}),e.jsxs("div",{className:"flex space-x-4 mb-2",children:[e.jsxs(l,{className:g(s.probability),children:["Probability: ",s.probability]}),e.jsxs(l,{className:j(s.impact),children:["Impact: ",s.impact]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Category: ",s.category," | Assignee: ",s.assignee]}),s.mitigationPlan&&e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Mitigation Plan:"})," ",s.mitigationPlan]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Due: ",new Date(s.dueDate).toLocaleDateString()]}),e.jsx(n,{size:"sm",variant:"outline",onClick:()=>m(s._id,"closed"),children:"Close"})]})]},s._id)})})})]})}),e.jsx(N,{value:"closed",className:"space-y-4",children:e.jsxs(c,{children:[e.jsx(r,{children:e.jsx(d,{children:"Closed Risks"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:P.map(s=>{const a=u(s.probability,s.impact);return e.jsxs("div",{className:"border rounded-lg p-4 border-green-200 bg-green-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsxs(l,{className:a.color,children:[a.level," Risk"]})]}),e.jsxs("div",{className:"flex space-x-4 mb-2",children:[e.jsxs(l,{className:g(s.probability),children:["Probability: ",s.probability]}),e.jsxs(l,{className:j(s.impact),children:["Impact: ",s.impact]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Category: ",s.category," | Assignee: ",s.assignee]}),s.mitigationPlan&&e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Mitigation Plan:"})," ",s.mitigationPlan]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Due: ",new Date(s.dueDate).toLocaleDateString()]})]},s._id)})})})]})})]}),I&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background p-6 rounded-lg w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add New Risk"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{placeholder:"Risk Title",value:t.title,onChange:s=>i({...t,title:s.target.value})}),e.jsx("textarea",{className:"w-full p-2 border rounded",placeholder:"Description",value:t.description,onChange:s=>i({...t,description:s.target.value}),rows:3}),e.jsxs("select",{className:"w-full p-2 border rounded",value:t.probability,onChange:s=>i({...t,probability:s.target.value}),"aria-label":"Select probability level",children:[e.jsx("option",{value:"low",children:"Low Probability"}),e.jsx("option",{value:"medium",children:"Medium Probability"}),e.jsx("option",{value:"high",children:"High Probability"})]}),e.jsxs("select",{className:"w-full p-2 border rounded",value:t.impact,onChange:s=>i({...t,impact:s.target.value}),"aria-label":"Select impact level",children:[e.jsx("option",{value:"low",children:"Low Impact"}),e.jsx("option",{value:"medium",children:"Medium Impact"}),e.jsx("option",{value:"high",children:"High Impact"})]}),e.jsx(b,{placeholder:"Category",value:t.category,onChange:s=>i({...t,category:s.target.value})}),e.jsx(b,{placeholder:"Assignee",value:t.assignee,onChange:s=>i({...t,assignee:s.target.value})}),e.jsx(b,{type:"date",value:t.dueDate,onChange:s=>i({...t,dueDate:s.target.value})}),e.jsx("textarea",{className:"w-full p-2 border rounded",placeholder:"Mitigation Plan",value:t.mitigationPlan,onChange:s=>i({...t,mitigationPlan:s.target.value}),rows:3}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(n,{onClick:S,className:"flex-1",children:"Add Risk"}),e.jsx(n,{variant:"outline",onClick:()=>v(!1),className:"flex-1",children:"Cancel"})]})]})]})})]})}export{J as default};
